<view class="mybooking-container">
  <!-- 搜索栏 -->
  <view class="search-bar">
    <view class="search-box">
      <input class="search-input" 
             placeholder="搜索已预定商品..." 
             value="{{searchKeyword}}" 
             bindinput="onSearchInput" 
             bindconfirm="onSearch" />
      <button class="search-btn" bindtap="onSearch">搜索</button>
    </view>
  </view>

  <!-- 分类筛选 -->
  <scroll-view class="category-scroll" scroll-x="true">
    <view class="category-list">
      <view class="category-item {{selectedCategory === item ? 'active' : ''}}" 
            wx:for="{{categories}}" 
            wx:key="*this" 
            data-category="{{item}}" 
            bindtap="onCategorySelect">
        {{item}}
      </view>
    </view>
  </scroll-view>

  <!-- 预定列表 -->
  <view class="product-list">
    <view class="product-item" wx:for="{{reservations}}" wx:key="id">
      <!-- 商品信息 -->
      <view class="product-card">
        <!-- 上半部分：图片和基本信息 -->
        <view class="card-top">
          <image class="product-image" 
                 src="{{item.image}}" 
                 mode="aspectFill" 
                 bindtap="onReserveDetail" 
                 data-id="{{item.id}}"></image>
          
          <view class="product-basic-info">
            <!-- 商品名称 -->
            <text class="product-name">{{item.name}}</text>
            
            <!-- 商品描述 -->
            <text class="product-description">{{item.description}}</text>
            
            <!-- 分类和卖家 -->
            <view class="product-meta">
              <text class="product-category">{{item.category}}</text>
              <text class="product-seller">{{item.sellerName}}</text>
            </view>
          </view>
        </view>
        
        <!-- 中间部分：价格和数量 -->
        <view class="card-middle">
          <view class="info-row">
            <text class="row-label">单价</text>
            <text class="row-value price">¥{{item.price}}</text>
          </view>
          <view class="info-row">
            <text class="row-label">数量</text>
            <text class="row-value">{{item.reserveQuantity}}</text>
          </view>
          <view class="info-row highlight">
            <text class="row-label">总价</text>
            <text class="row-value total">¥{{item.totalPrice}}</text>
          </view>
        </view>
        
        <!-- 底部部分：状态和操作 -->
        <view class="card-bottom">
          <view class="status-time">
            <view class="status-badge {{item.reserveStatus === 'waiting' ? 'status-waiting' : item.reserveStatus === 'delivering' ? 'status-delivering' : item.reserveStatus === 'ready' ? 'status-ready' : item.reserveStatus === 'completed' ? 'status-completed' : 'status-cancelled'}}">
              {{item.reserveStatus === 'waiting' ? '等待摊主接受预定' : item.reserveStatus === 'delivering' ? '飞奔中' : item.reserveStatus === 'ready' ? '待取货' : item.reserveStatus === 'completed' ? '已完成' : '已取消'}}
            </view>
            <text class="reserve-time">{{item.reserveTime}}</text>
          </view>
          
          <button class="cancel-btn" 
                  bindtap="onCancelReserve" 
                  data-id="{{item.id}}"
                  disabled="{{item.reserveStatus !== 'waiting'}}">
            {{item.reserveStatus === 'waiting' ? '取消预定' : item.reserveStatus === 'cancelled' ? '已取消' : '已完成'}}
          </button>
        </view>
      </view>
    </view>
    
    <!-- 空状态 -->
    <view class="empty-state" wx:if="{{reservations.length === 0 && !loading}}">
      <view class="empty-icon"></view>
      <text class="empty-text">暂无预定记录</text>
      <text class="empty-desc">快去预定心仪的商品吧</text>
    </view>
    
    <!-- 加载状态 -->
    <view class="loading-more" wx:if="{{loading}}">
      <text class="loading-text">加载中...</text>
    </view>
    
    <!-- 没有更多 -->
    <view class="no-more" wx:if="{{!hasMore && reservations.length > 0}}">
      <text class="no-more-text">没有更多记录了</text>
    </view>
  </view>
</view>
