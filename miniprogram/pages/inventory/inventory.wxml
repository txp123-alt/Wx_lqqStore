<view class="container">

  
  <view class="summary-section">
    <text class="summary-title">总库存统计</text>
    <view class="summary-item">
      <text class="summary-label">库存商品:</text>
      <text class="summary-value">{{totalInventoryCount}} 件</text>
    </view>
    <view class="summary-item">
      <text class="summary-label">出摊商品:</text>
      <text class="summary-value">{{stallItemsCount}} 件</text>
    </view>
    <view class="summary-item">
      <text class="summary-label">总量:</text>
      <text class="summary-value">{{totalItemsCount}} 件</text>
    </view>
  </view>
  
  <view class="list-section">
    <text class="section-title">库存商品列表</text>
    <view class="item-list">
      <view wx:for="{{inventoryItems}}" wx:key="id" class="item">
        <view class="item-image">
          <image src="{{item.image || '/images/default-goods-image.png'}}" mode="aspectFill" class="goods-thumbnail"></image>
        </view>
        <view class="item-info">
          <text class="item-name">{{item.name}}</text>
          <text class="item-count">库存数量: {{item.count}}</text>
          <text class="item-cost">成本: ¥{{item.cost}}</text>
        </view>
        <view class="item-actions">
          <button size="mini" type="primary" bindtap="showAddToStallModal" data-id="{{item.id}}">添加到出摊</button>
        </view>
      </view>
      <view wx:if="{{inventoryItems.length === 0}}" class="empty">
        <text>暂无库存商品</text>
      </view>
    </view>
  </view>
  
  <view class="add-section">
    <view class="input-group">
      <input type="text" placeholder="商品名称" bindinput="onNameInput" value="{{newItem.name}}" />
      <input type="number" placeholder="初始库存" bindinput="onCountInput" value="{{newItem.count}}" />
      <input type="digit" placeholder="商品成本（元）" bindinput="onCostInput" value="{{newItem.cost}}" />
    </view>
    
    <!-- 图片上传区域 -->
    <view class="image-upload-section">
      <text class="upload-label">商品图片</text>
      <view class="image-upload-container">
        <view wx:if="{{newItem.image}}" class="image-preview">
          <image class="preview-image" src="{{newItem.image}}" mode="aspectFill"></image>
          <view class="remove-image" bindtap="removeImage">
            <text class="remove-icon">×</text>
          </view>
        </view>
        <view wx:else class="upload-placeholder" bindtap="chooseImage">
          <text class="upload-icon">📷</text>
          <text class="upload-text">点击上传图片</text>
        </view>
      </view>
    </view>
    
    <button type="primary" bindtap="addItem">添加到库存</button>
  </view>

  <!-- 添加到出摊弹框 -->
  <view class="modal-overlay" wx:if="{{showAddToStallModal}}">
    <view class="modal">
      <view class="modal-header">
        <text class="modal-title">添加到出摊</text>
      </view>
      <view class="modal-content">
        <view class="modal-info">
          <text class="modal-label">商品名称:</text>
          <text class="modal-value">{{selectedItem.name}}</text>
        </view>
        <view class="modal-info">
          <text class="modal-label">库存数量:</text>
          <text class="modal-value">{{selectedItem.count}} 件</text>
        </view>
        <view class="input-group">
          <text class="input-label">出摊数量:</text>
          <input type="number" placeholder="请输入出摊数量" bindinput="onStallCountInput" value="{{stallCount}}" />
        </view>
      </view>
      <view class="modal-footer">
        <button type="default" bindtap="hideAddToStallModal">取消</button>
        <button type="primary" bindtap="confirmAddToStall">确认添加</button>
      </view>
    </view>
  </view>
</view>